[tox]
skipsdist = true
envlist = py37, py38, py39

[testenv]
sitepackages = True
install_command = pip install {opts} {packages}

deps =
    -rrequirements.txt

whitelist_externals =
    pytest
    sleep
    docker-compose
setenv =
  PYTHONPATH=../../src
  HT_SERVICE_NAME=python_agent_test1
#  HT_TRACES_EXPORTER=zipkin
#  HT_REPORTING_ENDPOINT=http://localhost:9411/api/v2/spans
#  HT_LOG_LEVEL=DEBUG
  HT_ENABLE_CONSOLE_SPAN_EXPORTER=True

commands =
    docker-compose up -d
    sleep 10
    pytest -rPx test_flask_1.py
    pytest -rPx test_flask_2.py
    pytest -rPx test_flask_3.py
    pytest -rPx test_flask_4.py
    pytest -rPx test_flask_5.py
    pytest -rPx test_flask_6.py
    pytest -rPx test_flask_8.py
    docker-compose stop
recreate = True
