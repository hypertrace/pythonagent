[tox]
envlist = test_flask_instrumentation
skipsdist = true

[testenv]
install_command = pip install {opts} {packages}
basepython=python3.8
sitepackages = True

[testenv:test_flask_instrumentation]
deps =
    -rrequirements.txt

whitelist_externals =
    docker-compose
    chcon
    sleep
setenv =
  PYTHONPATH=../..

commands =
    docker-compose stop
    docker-compose rm -v -f
    docker-compose pull db
    chcon -Rt svirt_sandbox_file_t sql
    docker-compose up -d db
    sleep 20
    python mysql_test_1.py
    docker-compose stop db
[testenv:train_model]
envdir = {toxworkdir}

deps =
    {[testenv:test_flask_instrumentation]deps}

setenv =
  {[testenv:test_flask_instrumentation]setenv}

